(()=>{"use strict";var e,t=1e-6,r="undefined"!=typeof Float32Array?Float32Array:Array;function n(e,t,n){var o=new r(3);return o[0]=e,o[1]=t,o[2]=n,o}function o(){var e=new r(16);return r!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function a(e,t,r){var n=t[0],o=t[1],a=t[2],i=t[3],u=t[4],c=t[5],s=t[6],f=t[7],l=t[8],d=t[9],p=t[10],v=t[11],m=t[12],h=t[13],g=t[14],y=t[15],w=r[0],x=r[1],b=r[2],P=r[3];return e[0]=w*n+x*u+b*l+P*m,e[1]=w*o+x*c+b*d+P*h,e[2]=w*a+x*s+b*p+P*g,e[3]=w*i+x*f+b*v+P*y,w=r[4],x=r[5],b=r[6],P=r[7],e[4]=w*n+x*u+b*l+P*m,e[5]=w*o+x*c+b*d+P*h,e[6]=w*a+x*s+b*p+P*g,e[7]=w*i+x*f+b*v+P*y,w=r[8],x=r[9],b=r[10],P=r[11],e[8]=w*n+x*u+b*l+P*m,e[9]=w*o+x*c+b*d+P*h,e[10]=w*a+x*s+b*p+P*g,e[11]=w*i+x*f+b*v+P*y,w=r[12],x=r[13],b=r[14],P=r[15],e[12]=w*n+x*u+b*l+P*m,e[13]=w*o+x*c+b*d+P*h,e[14]=w*a+x*s+b*p+P*g,e[15]=w*i+x*f+b*v+P*y,e}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),e=new r(3),r!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0);const i=()=>{let e="";return navigator.gpu||(e="Your current browser does not support WebGPU!."),e},u=(e="canvas-webgpu")=>{return t=void 0,r=void 0,o=function*(){var t;if(i().includes("Your current browser does not support WebGPU!"))throw"No WebGPU Support!";const r=document.getElementById(e),n=yield null===(t=navigator.gpu)||void 0===t?void 0:t.requestAdapter(),o=yield null==n?void 0:n.requestDevice(),a=r.getContext("webgpu"),u=window.devicePixelRatio||1,c=[r.clientWidth*u,r.clientHeight*u];r.width=c[0],r.height=c[1];const s=yield navigator.gpu.getPreferredCanvasFormat();return a.configure({alphaMode:"premultiplied",device:o,format:s}),{device:o,canvas:r,format:s,context:a}},new((n=void 0)||(n=Promise))((function(e,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function u(e){try{c(o.throw(e))}catch(e){a(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,u)}c((o=o.apply(t,r||[])).next())}));var t,r,n,o},c=(e,t,r=GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST)=>{const n=e.createBuffer({size:t.byteLength,usage:r,mappedAtCreation:!0});return new Float32Array(n.getMappedRange()).set(t),n.unmap(),n},s=()=>({positions:new Float32Array([-1,-1,1,1,-1,1,1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1]),colors:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1])}),f=(e,t=[0,0,0],r=[0,0,0],n=[1,1,1])=>{const i=o(),u=o(),c=o(),s=o(),f=o();!function(e,t){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1}(s,t),function(e,t){var r=Math.sin(t),n=Math.cos(t);e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(i,r[0]),function(e,t){var r=Math.sin(t),n=Math.cos(t);e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(u,r[1]),function(e,t){var r=Math.sin(t),n=Math.cos(t);e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(c,r[2]),function(e,t){e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(f,n),a(e,i,f),a(e,u,e),a(e,c,e),a(e,s,e)},l=(e=1,r=[2,2,4],n=[0,0,0],i=[0,1,0])=>{const u=o(),c=o(),s=o();return function(e,t,r,n,o){var a,i=1/Math.tan(t/2);e[0]=i/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=o&&o!==1/0?(a=1/(n-o),e[10]=(o+n)*a,e[14]=2*o*n*a):(e[10]=-1,e[14]=-2*n)}(c,2*Math.PI/5,e,.1,100),function(e,r,n,o){var a,i,u,c,s,f,l,d,p,v,m=r[0],h=r[1],g=r[2],y=o[0],w=o[1],x=o[2],b=n[0],P=n[1],M=n[2];Math.abs(m-b)<t&&Math.abs(h-P)<t&&Math.abs(g-M)<t?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(l=m-b,d=h-P,p=g-M,a=w*(p*=v=1/Math.hypot(l,d,p))-x*(d*=v),i=x*(l*=v)-y*p,u=y*d-w*l,(v=Math.hypot(a,i,u))?(a*=v=1/v,i*=v,u*=v):(a=0,i=0,u=0),c=d*u-p*i,s=p*a-l*u,f=l*i-d*a,(v=Math.hypot(c,s,f))?(c*=v=1/v,s*=v,f*=v):(c=0,s=0,f=0),e[0]=a,e[1]=c,e[2]=l,e[3]=0,e[4]=i,e[5]=s,e[6]=d,e[7]=0,e[8]=u,e[9]=f,e[10]=p,e[11]=0,e[12]=-(a*m+i*h+u*g),e[13]=-(c*m+s*h+f*g),e[14]=-(l*m+d*h+p*g),e[15]=1)}(u,r,n,i),a(s,c,u),{viewMatrix:u,projectionMatrix:c,viewProjectionMatrix:s,cameraOption:{eye:r,center:n,zoomMax:100,zoomSpeed:2}}},d="// vertex shader\r\nstruct Output {\r\n    @builtin(position) Position : vec4<f32>,\r\n    @location(0) vColor : vec4<f32>\r\n};\r\n\r\n@stage(vertex)\r\nfn vs_main(@location(0) pos: vec4<f32>, @location(1) color: vec4<f32>) -> Output {\r\n    var output: Output;\r\n    output.Position = pos;\r\n    output.vColor = color;\r\n    return output;\r\n}\r\n\r\n// fragment shader\r\n\r\n@stage(fragment)\r\nfn fs_main(@location(0) vColor: vec4<f32>) -> @location(0) vec4<f32> {\r\n    return vColor;\r\n}";document.getElementById("id-gpu-check").innerHTML=i();const p="// vertex shader\r\nstruct Output {\r\n    @builtin(position) Position : vec4<f32>,\r\n    @location(0) vColor : vec4<f32>\r\n};\r\n\r\n@stage(vertex)\r\nfn vs_main(@location(0) pos: vec4<f32>, @location(1) color: vec4<f32>) -> Output {\r\n    var output: Output;\r\n    output.Position = pos;\r\n    output.vColor = color;\r\n    return output;\r\n}\r\n\r\n// fragment shader\r\n\r\n@stage(fragment)\r\nfn fs_main(@location(0) vColor: vec4<f32>) -> @location(0) vec4<f32> {\r\n    return vColor;\r\n}";document.getElementById("id-gpu-check").innerHTML=i();const v=()=>{return e=void 0,t=void 0,n=function*(){const e=yield u("canvas-webgpu-06"),t=e.device,r=new Float32Array([-.5,-.5,1,0,0,.5,-.5,0,1,0,-.5,.5,1,1,0,.5,.5,0,0,1]),n=new Uint32Array([0,1,2,3,1,2]),o=c(t,r),a=((e,t,r=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST)=>{const n=e.createBuffer({size:t.byteLength,usage:r,mappedAtCreation:!0});return new Uint32Array(n.getMappedRange()).set(t),n.unmap(),n})(t,n),i=t.createRenderPipeline({vertex:{module:t.createShaderModule({code:p}),entryPoint:"vs_main",buffers:[{arrayStride:20,attributes:[{shaderLocation:0,format:"float32x2",offset:0},{shaderLocation:1,format:"float32x2",offset:8}]}]},fragment:{module:t.createShaderModule({code:p}),entryPoint:"fs_main",targets:[{format:e.format}]},primitive:{topology:"triangle-list"},layout:t.createPipelineLayout({bindGroupLayouts:[]})}),s=t.createCommandEncoder(),f=e.context.getCurrentTexture().createView(),l=s.beginRenderPass({colorAttachments:[{view:f,clearValue:{r:.2,g:.4,b:.2,a:1},loadOp:"clear",storeOp:"store"}]});l.setPipeline(i),l.setVertexBuffer(0,o),l.setIndexBuffer(a,"uint32"),l.drawIndexed(6),l.end(),t.queue.submit([s.finish()])},new((r=void 0)||(r=Promise))((function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,u)}c((n=n.apply(e,t||[])).next())}));var e,t,r,n},m="// vertex shader\r\n\r\nstruct Uniforms {\r\n    mvpMatrix : mat4x4<f32>\r\n};\r\n@binding(0) @group(0) var<uniform> uniforms : Uniforms;\r\n\r\nstruct Output {\r\n    @builtin(position) Position : vec4<f32>,\r\n    @location(0) vColor : vec4<f32>\r\n};\r\n\r\n@stage(vertex)\r\nfn vs_main(@location(0) pos: vec4<f32>, @location(1) color: vec4<f32>) -> Output {\r\n    var output: Output;\r\n    output.Position = uniforms.mvpMatrix * pos;\r\n    output.vColor = color;\r\n    return output;\r\n}\r\n\r\n// fragment shader\r\n\r\n @stage(fragment)\r\nfn fs_main(@location(0) vColor: vec4<f32>) -> @location(0) vec4<f32> {\r\n    return vColor;\r\n}";document.getElementById("id-gpu-check").innerHTML=i();const h=()=>{return e=void 0,t=void 0,n=function*(){const e=yield u("canvas-webgpu-07"),t=e.device,r=s(),n=r.positions.length/3,i=c(t,r.positions),d=c(t,r.colors),p=t.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}}]}),v=t.createRenderPipeline({vertex:{module:t.createShaderModule({code:m}),entryPoint:"vs_main",buffers:[{arrayStride:12,attributes:[{shaderLocation:0,format:"float32x3",offset:0}]},{arrayStride:12,attributes:[{shaderLocation:1,format:"float32x3",offset:0}]}]},fragment:{module:t.createShaderModule({code:m}),entryPoint:"fs_main",targets:[{format:e.format}]},primitive:{topology:"triangle-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"},layout:t.createPipelineLayout({bindGroupLayouts:[p]})}),h=o(),g=o();let y=o();y=l(e.canvas.width/e.canvas.height).viewProjectionMatrix;const w=t.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),x=t.createBindGroup({layout:v.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:w,offset:0,size:64}}]}),b=e.context.getCurrentTexture().createView(),P=t.createTexture({size:[e.canvas.width,e.canvas.height,1],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT});f(h),a(g,y,h),t.queue.writeBuffer(w,0,g);const M=t.createCommandEncoder(),C=M.beginRenderPass({colorAttachments:[{view:b,clearValue:{r:.2,g:.4,b:.2,a:1},loadOp:"clear",storeOp:"store"}],depthStencilAttachment:{view:P.createView({aspect:"all"}),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store",depthReadOnly:!1}});C.setPipeline(v),C.setVertexBuffer(0,i),C.setVertexBuffer(1,d),C.setBindGroup(0,x),C.draw(n),C.end(),t.queue.submit([M.finish()])},new((r=void 0)||(r=Promise))((function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,u)}c((n=n.apply(e,t||[])).next())}));var e,t,r,n},g="// vertex shader\r\n\r\nstruct Uniforms {\r\n    mvpMatrix : mat4x4<f32>\r\n};\r\n@binding(0) @group(0) var<uniform> uniforms : Uniforms;\r\n\r\nstruct Output {\r\n    @builtin(position) Position : vec4<f32>,\r\n    @location(0) vColor : vec4<f32>\r\n};\r\n\r\n@stage(vertex)\r\nfn vs_main(@location(0) pos: vec4<f32>, @location(1) color: vec4<f32>) -> Output {\r\n    var output: Output;\r\n    output.Position = uniforms.mvpMatrix * pos;\r\n    output.vColor = color;\r\n    return output;\r\n}\r\n\r\n// fragment shader\r\n\r\n @stage(fragment)\r\nfn fs_main(@location(0) vColor: vec4<f32>) -> @location(0) vec4<f32> {\r\n    return vColor;\r\n}";document.getElementById("id-gpu-check").innerHTML=i();const y=e=>{return t=void 0,r=void 0,d=function*(){const t=yield u("canvas-webgpu-08"),r=t.device,i=s(),d=i.positions.length/3,p=c(r,i.positions),v=c(r,i.colors),m=r.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}}]}),h=r.createRenderPipeline({vertex:{module:r.createShaderModule({code:g}),entryPoint:"vs_main",buffers:[{arrayStride:12,attributes:[{shaderLocation:0,format:"float32x3",offset:0}]},{arrayStride:12,attributes:[{shaderLocation:1,format:"float32x3",offset:0}]}]},fragment:{module:r.createShaderModule({code:g}),entryPoint:"fs_main",targets:[{format:t.format}]},primitive:{topology:"triangle-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"},layout:r.createPipelineLayout({bindGroupLayouts:[m]})}),y=o(),w=o();let x=o();const b=l(t.canvas.width/t.canvas.height,[0,20,10]);x=b.viewProjectionMatrix;let P=n(0,0,0),M=n(1,1,1),C=n(0,0,0);const B=r.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),O=r.createBindGroup({layout:h.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:B,offset:0,size:64}}]});let U=t.context.getCurrentTexture().createView(),L=r.createTexture({size:[t.canvas.width,t.canvas.height,1],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT});const E={colorAttachments:[{view:U,clearValue:{r:.2,g:.4,b:.2,a:1},loadOp:"clear",storeOp:"store"}],depthStencilAttachment:{view:L.createView({aspect:"all"}),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store",depthReadOnly:!1}};((e,t=n(0,0,0),r=n(0,0,0),o=n(1,1,1),a)=>{requestAnimationFrame((function n(){"rotation"===a?(r[0]+=.01,r[1]+=.01,r[2]+=.01,t=[0,0,0],o=[1,1,1]):"translate"===a?(t[0]+=.01,t[0]>3&&(t[0]=-3),r=[0,0,0],o=[1,1,1]):"scale"===a&&(o[0]+=.01,o[1]+=.01,o[2]+=.01,o[0]>2&&(o[0]=1,o[1]=1,o[2]=1),r=[0,0,0],t=[0,0,0]),e(),requestAnimationFrame(n)}))})((()=>{f(y,C,P,M),a(w,x,y),r.queue.writeBuffer(B,0,w),U=t.context.getCurrentTexture().createView(),E.colorAttachments[0].view=U;const e=r.createCommandEncoder(),n=e.beginRenderPass(E);n.setPipeline(h),n.setVertexBuffer(0,p),n.setVertexBuffer(1,v),n.setBindGroup(0,O),n.draw(d),n.end(),r.queue.submit([e.finish()])}),C,P,M,e)},new((i=void 0)||(i=Promise))((function(e,n){function o(e){try{u(d.next(e))}catch(e){n(e)}}function a(e){try{u(d.throw(e))}catch(e){n(e)}}function u(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(o,a)}u((d=d.apply(t,r||[])).next())}));var t,r,i,d};switch(document.getElementsByTagName("canvas")[0].id.slice(-2)){case"05":w=void 0,x=void 0,P=function*(){const e=yield u("canvas-webgpu-05"),t=e.device,r=new Float32Array([-.5,-.5,1,0,0,.5,-.5,0,1,0,-.5,.5,1,1,0,-.5,.5,1,1,0,.5,-.5,0,1,0,.5,.5,0,0,1]),n=c(t,r),o=t.createRenderPipeline({vertex:{module:t.createShaderModule({code:d}),entryPoint:"vs_main",buffers:[{arrayStride:20,attributes:[{shaderLocation:0,format:"float32x2",offset:0},{shaderLocation:1,format:"float32x2",offset:8}]}]},fragment:{module:t.createShaderModule({code:d}),entryPoint:"fs_main",targets:[{format:e.format}]},primitive:{topology:"triangle-list"},layout:t.createPipelineLayout({bindGroupLayouts:[]})}),a=t.createCommandEncoder(),i=e.context.getCurrentTexture().createView(),s=a.beginRenderPass({colorAttachments:[{view:i,clearValue:{r:.2,g:.4,b:.2,a:1},loadOp:"clear",storeOp:"store"}]});s.setPipeline(o),s.setVertexBuffer(0,n),s.draw(6),s.end(),t.queue.submit([a.finish()])},new((b=void 0)||(b=Promise))((function(e,t){function r(e){try{o(P.next(e))}catch(e){t(e)}}function n(e){try{o(P.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof b?o:new b((function(e){e(o)}))).then(r,n)}o((P=P.apply(w,x||[])).next())}));break;case"06":v();break;case"07":h(),window.addEventListener("resize",(function(){h()}));break;case"08":const e=document.getElementById("select-transform")||document.createElement("select"),t=e.value;y(t),window.addEventListener("resize",(function(){y(t)})),e.addEventListener("change",(()=>y(e.value)))}var w,x,b,P})();
//# sourceMappingURL=main.bundle.js.map